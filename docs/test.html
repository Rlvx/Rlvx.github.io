<h1 id="writup-de-xtraordinary---picoctf">Writup de XtraORdinary - PicoCTF</h1>
<h3 id="description-initiale-">Description initiale :</h3>
<p>Check out my new, never-before-seen method of encryption! I totally invented it myself. I added so many for loops that I don’t even know what it does. It’s extraordinarily secure!</p>
<p>files :</p>
<p><a href="https://artifacts.picoctf.net/picoMini+by+redpwn/Cryptography/xtraordinary/output.txt">output.txt</a></p>
<p><a href="https://artifacts.picoctf.net/picoMini+by+redpwn/Cryptography/xtraordinary/encrypt.py">encrypt.py</a></p>
<hr>
<h3 id="fichier-output.txt">Fichier <a href="https://artifacts.picoctf.net/picoMini+by+redpwn/Cryptography/xtraordinary/output.txt">output.txt</a></h3>
<pre><code>57657535570c1e1c612b3468106a18492140662d2f5967442a2960684d28017931617b1f3637
</code></pre>
<h3 id="fichier-encrypt.py">Fichier <a href="https://artifacts.picoctf.net/picoMini+by+redpwn/Cryptography/xtraordinary/encrypt.py">encrypt.py</a></h3>
<pre class=" language-py"><code class="prism  language-py"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">from</span> random <span class="token keyword">import</span> randint

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    flag <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'secret-key.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    key <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>ptxt<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ctxt <span class="token operator">=</span> b<span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ptxt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        a <span class="token operator">=</span> ptxt<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        b <span class="token operator">=</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span>
        ctxt <span class="token operator">+=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>a <span class="token operator">^</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ctxt

ctxt <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> key<span class="token punctuation">)</span>

random_strs <span class="token operator">=</span> <span class="token punctuation">[</span>
    b<span class="token string">'my encryption method'</span><span class="token punctuation">,</span>
    b<span class="token string">'is absolutely impenetrable'</span><span class="token punctuation">,</span>
    b<span class="token string">'and you will never'</span><span class="token punctuation">,</span>
    b<span class="token string">'ever'</span><span class="token punctuation">,</span>
    b<span class="token string">'ever'</span><span class="token punctuation">,</span>
    b<span class="token string">'ever'</span><span class="token punctuation">,</span>
    b<span class="token string">'ever'</span><span class="token punctuation">,</span>
    b<span class="token string">'ever'</span><span class="token punctuation">,</span>
    b<span class="token string">'ever'</span><span class="token punctuation">,</span>
    b<span class="token string">'break it'</span>
<span class="token punctuation">]</span>

<span class="token keyword">for</span> random_str <span class="token keyword">in</span> random_strs<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        ctxt <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>ctxt<span class="token punctuation">,</span> random_str<span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ctxt<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="explication-du-programme">Explication du programme</h3>
<p>Ici nous n’avons pas d’autre indication que le programme python, aucun serveur n’est donné, donc on ne pourra pas avoir plus d’informations. Il faut donc comprendre dans sa globalité, le programme python. tout d’abord, le <code>flag</code> est contenu dans le fichier <code>flag.txt</code> et la clé secrète dans le fichier <code>secret-key.txt</code>. le contenu <strong>bytes</strong> de ces fichiers sont respectivement mis dans les variables <code>flag</code> et <code>key</code>. La fonction encrypt est une fonction <strong>XOR</strong>, pas besoin d’aller plus loin dans l’explication, on va devoir utiliser une faille dans les propriétés du XOR pour retrouver le texte en clair. le tableau <code>random_strs</code> contient des clés connues qui seront utilisées pour XORER à plusieurs reprises le texte en clair. on verra ça après. Ensuite, le programme va xorer le message (idem, je vais expliquer en détail cette partie après) et enfin écrire dans le fichier <code>output.txt</code> la valeur du ciphertext en hexadécimal.</p>
<p>Avant d’aller plus loin, on va faire un petit rappel des propriétés du XOR</p>
<p><strong>Propritétés importantes du xor :</strong></p>
<blockquote>
<p>A⊕B=B⊕A<br>
A⊕(B⊕C)=(A⊕B)⊕C<br>
A⊕0=A<br>
A⊕A=0</p>
<p>le symbole ⊕ (parfois ^) correspond à la fonction XOR</p>
</blockquote>
<h3 id="explication-du-chiffrement-xor">Explication du “chiffrement” xor</h3>
<p>On va donc passer à l’explication de cette partie de code :</p>
<pre class=" language-py"><code class="prism  language-py"><span class="token keyword">for</span> random_str <span class="token keyword">in</span> random_strs<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        ctxt <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>ctxt<span class="token punctuation">,</span> random_str<span class="token punctuation">)</span>
</code></pre>
<blockquote>
<p>il faut bien comprendre que <strong>encrypt() = xor()</strong> !!!</p>
</blockquote>
<p>déjà pour avoir moins mal aux yeux on va transformer le code un peu</p>
<pre class=" language-py"><code class="prism  language-py"><span class="token keyword">for</span> random_str <span class="token keyword">in</span> random_strs<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1048576</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	    ctxt <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>ctxt<span class="token punctuation">,</span> random_str<span class="token punctuation">)</span>
</code></pre>
<p>c’est déjà mieux. Maintenant reprenons les propriétés du XOR et particulièrement, celles-ci : <code>A⊕A=0</code> et <code>A⊕0=A</code>. Dans cette fonction on répète <code>i</code> fois le processus <code>c ⊕ k</code> (en prenant <code>c=ctxt</code> et <code>k=random_str</code> donc :<br>
<code>c = c ⊕ k ⊕ k ⊕ k ⊕ k ⊕ k ... i fois</code> or <code>k ⊕ k = 0</code> et <code>c ⊕ 0 = c</code>. Donc il ne sert à rien du savoir combien de fois on a fait la boucle, mais si <code>i</code> est pair ou non. de cette manière le “bon ciphertext” n’est plus parmi <code>1048576</code> possibilité mais seulement <code>2</code> (<code>c</code> ou <code>c ⊕ k</code>). Néanmoins on ne va pas voir uniquement 2 ciphertext à tester, car il faut prendre en compte la boucle  :</p>
<pre class=" language-py"><code class="prism  language-py"> <span class="token keyword">for</span> random_str <span class="token keyword">in</span> random_strs<span class="token punctuation">:</span>
</code></pre>
<p>étant donné que la liste <code>random_strs</code> est de longueur 10, le nombre de ciphertext possible s’élève à <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>10</mn></msup></mrow><annotation encoding="application/x-tex">2^{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span></span></span></span></span> sois <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1024</mn></mrow><annotation encoding="application/x-tex">1024</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1024</span></span></span></span></span> ce qui est très acceptable. <strong>à noter que nous n’allons pas trouver le flag avec cette méthode mais le ciphertext racine, celui qui résulte de l’opération xor(flag,key)</strong>.</p>
<h3 id="récupération-des-potentiels-ciphertexts_racines">Récupération des potentiels ciphertexts_racines</h3>
<p>le but est de récupérer un tableau de maximum 1024 possibilités (je dis max car il est possible qu’il y ait doublons que je n’ajouterais pas au tableau), contenant la liste des potentiels ciphertexts_racines dans laquelle se trouve le véritable ciphertext racine.</p>
<pre class=" language-py"><code class="prism  language-py">random_strs <span class="token operator">=</span> <span class="token punctuation">[</span>  
  b<span class="token string">'my encryption method'</span><span class="token punctuation">,</span>  
  b<span class="token string">'is absolutely impenetrable'</span><span class="token punctuation">,</span>  
  b<span class="token string">'and you will never'</span><span class="token punctuation">,</span>  
  b<span class="token string">'ever'</span><span class="token punctuation">,</span>  
  b<span class="token string">'ever'</span><span class="token punctuation">,</span>  
  b<span class="token string">'ever'</span><span class="token punctuation">,</span>  
  b<span class="token string">'ever'</span><span class="token punctuation">,</span>  
  b<span class="token string">'ever'</span><span class="token punctuation">,</span>  
  b<span class="token string">'ever'</span><span class="token punctuation">,</span>  
  b<span class="token string">'break it'</span>  
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>  
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"decrypting "</span><span class="token punctuation">,</span>value<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
  potential_root_ciphertexts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
  potential_root_ciphertexts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>value<span class="token punctuation">)</span>  
  random_strs<span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> random_str <span class="token keyword">in</span> random_strs<span class="token punctuation">:</span>  
	  <span class="token builtin">buffer</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
	  <span class="token keyword">for</span> potential_root_ciphertext <span class="token keyword">in</span> potential_root_ciphertexts<span class="token punctuation">:</span>  
		  enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>potential_root_ciphertext<span class="token punctuation">,</span> random_str<span class="token punctuation">)</span>  
		  <span class="token keyword">if</span> enc <span class="token operator">not</span> <span class="token keyword">in</span> <span class="token builtin">buffer</span> <span class="token operator">and</span> enc <span class="token operator">not</span> <span class="token keyword">in</span> potential_root_ciphertexts<span class="token punctuation">:</span>  
			  <span class="token builtin">buffer</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>enc<span class="token punctuation">)</span>  
	  potential_root_ciphertexts <span class="token operator">+=</span> <span class="token builtin">buffer</span>
	
  <span class="token keyword">print</span><span class="token punctuation">(</span>potential_root_ciphertexts<span class="token punctuation">)</span>
</code></pre>
<p>je vais faire un graphique pour expliquer comment je remplis ce tableau :</p>
<pre class=" language-mermaid"><svg id="mermaid-svg-h8gOSIR5Qjx0bOIe" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="352.86663818359375" style="max-width: 562.6333618164062px;" viewBox="0 0 562.6333618164062 352.86663818359375"><style>#mermaid-svg-h8gOSIR5Qjx0bOIe{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#000000;}#mermaid-svg-h8gOSIR5Qjx0bOIe .error-icon{fill:#552222;}#mermaid-svg-h8gOSIR5Qjx0bOIe .error-text{fill:#552222;stroke:#552222;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edge-thickness-normal{stroke-width:2px;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg-h8gOSIR5Qjx0bOIe .marker{fill:#666;stroke:#666;}#mermaid-svg-h8gOSIR5Qjx0bOIe .marker.cross{stroke:#666;}#mermaid-svg-h8gOSIR5Qjx0bOIe svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg-h8gOSIR5Qjx0bOIe .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#000000;}#mermaid-svg-h8gOSIR5Qjx0bOIe .cluster-label text{fill:#333;}#mermaid-svg-h8gOSIR5Qjx0bOIe .cluster-label span{color:#333;}#mermaid-svg-h8gOSIR5Qjx0bOIe .label text,#mermaid-svg-h8gOSIR5Qjx0bOIe span{fill:#000000;color:#000000;}#mermaid-svg-h8gOSIR5Qjx0bOIe .node rect,#mermaid-svg-h8gOSIR5Qjx0bOIe .node circle,#mermaid-svg-h8gOSIR5Qjx0bOIe .node ellipse,#mermaid-svg-h8gOSIR5Qjx0bOIe .node polygon,#mermaid-svg-h8gOSIR5Qjx0bOIe .node path{fill:#eee;stroke:#999;stroke-width:1px;}#mermaid-svg-h8gOSIR5Qjx0bOIe .node .label{text-align:center;}#mermaid-svg-h8gOSIR5Qjx0bOIe .node.clickable{cursor:pointer;}#mermaid-svg-h8gOSIR5Qjx0bOIe .arrowheadPath{fill:#333333;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edgePath .path{stroke:#666;stroke-width:1.5px;}#mermaid-svg-h8gOSIR5Qjx0bOIe .flowchart-link{stroke:#666;fill:none;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edgeLabel{background-color:white;text-align:center;}#mermaid-svg-h8gOSIR5Qjx0bOIe .edgeLabel rect{opacity:0.5;background-color:white;fill:white;}#mermaid-svg-h8gOSIR5Qjx0bOIe .cluster rect{fill:hsl(210,66.6666666667%,95%);stroke:#26a;stroke-width:1px;}#mermaid-svg-h8gOSIR5Qjx0bOIe .cluster text{fill:#333;}#mermaid-svg-h8gOSIR5Qjx0bOIe .cluster span{color:#333;}#mermaid-svg-h8gOSIR5Qjx0bOIe div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(-160,0%,93.3333333333%);border:1px solid #26a;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg-h8gOSIR5Qjx0bOIe:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg-h8gOSIR5Qjx0bOIe flowchart{fill:apa;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-init LE-cléK1" style="opacity: 1;" id="L-init-cléK1"><path class="path" d="M37.48332977294922,54.71665954589844L37.48332977294922,79.71665954589844L37.48332977294922,104.71665954589844" marker-end="url(https://stackedit.io/app#arrowhead87)" style="fill:none"></path><defs><marker id="arrowhead87" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-cléK1 LE-cléK2" style="opacity: 1;" id="L-cléK1-cléK2"><path class="path" d="M37.48332977294922,151.43331909179688L37.48332977294922,176.43331909179688L37.48332977294922,201.43331909179688" marker-end="url(https://stackedit.io/app#arrowhead88)" style="fill:none"></path><defs><marker id="arrowhead88" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-cléK2 LE-.." style="opacity: 1;" id="L-cléK2-.."><path class="path" d="M37.48332977294922,248.1499786376953L37.48332977294922,273.1499786376953L37.48332977294922,298.1499786376953" marker-end="url(https://stackedit.io/app#arrowhead89)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead89" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-A LE-B" style="opacity: 1;" id="L-A-B"><path class="path" d="M299.84166717529297,38.06753425717938L187.17082977294922,79.71665954589844L187.17082977294922,104.71665954589844" marker-end="url(https://stackedit.io/app#arrowhead90)" style="fill:none"></path><defs><marker id="arrowhead90" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-A LE-C" style="opacity: 1;" id="L-A-C"><path class="path" d="M336.1416702270508,39.124760244057164L431.0041732788086,79.71665954589844L431.0041732788086,104.71665954589844" marker-end="url(https://stackedit.io/app#arrowhead91)" style="fill:none"></path><defs><marker id="arrowhead91" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-B LE-D" style="opacity: 1;" id="L-B-D"><path class="path" d="M169.0208282470703,144.9363431943966L135.11666107177734,176.43331909179688L135.11666107177734,201.43331909179688" marker-end="url(https://stackedit.io/app#arrowhead92)" style="fill:none"></path><defs><marker id="arrowhead92" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-D LE-..." style="opacity: 1;" id="L-D-..."><path class="path" d="M135.11666107177734,248.1499786376953L135.11666107177734,273.1499786376953L135.11666107177734,298.1499786376953" marker-end="url(https://stackedit.io/app#arrowhead93)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead93" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-B LE-E" style="opacity: 1;" id="L-B-E"><path class="path" d="M205.32083129882812,144.9363431943966L239.2249984741211,176.43331909179688L239.2249984741211,201.43331909179688" marker-end="url(https://stackedit.io/app#arrowhead94)" style="fill:none"></path><defs><marker id="arrowhead94" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-E LE-...." style="opacity: 1;" id="L-E-...."><path class="path" d="M239.2249984741211,248.1499786376953L239.2249984741211,273.1499786376953L239.2249984741211,298.1499786376953" marker-end="url(https://stackedit.io/app#arrowhead95)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead95" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-C LE-F" style="opacity: 1;" id="L-C-F"><path class="path" d="M397.2587690700911,151.43331909179688L361.1416702270508,176.43331909179688L361.1416702270508,201.43331909179688" marker-end="url(https://stackedit.io/app#arrowhead96)" style="fill:none"></path><defs><marker id="arrowhead96" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-F LE-....." style="opacity: 1;" id="L-F-....."><path class="path" d="M361.1416702270508,248.1499786376953L361.1416702270508,273.1499786376953L361.1416702270508,298.1499786376953" marker-end="url(https://stackedit.io/app#arrowhead97)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead97" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-C LE-G" style="opacity: 1;" id="L-C-G"><path class="path" d="M464.7495774875261,151.43331909179688L500.8666763305664,176.43331909179688L500.8666763305664,201.43331909179688" marker-end="url(https://stackedit.io/app#arrowhead98)" style="fill:none"></path><defs><marker id="arrowhead98" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g><g class="edgePath LS-G LE-......" style="opacity: 1;" id="L-G-......"><path class="path" d="M500.8666763305664,248.1499786376953L500.8666763305664,273.1499786376953L500.8666763305664,298.1499786376953" marker-end="url(https://stackedit.io/app#arrowhead99)" style="fill:none;stroke-width:2px;stroke-dasharray:3;"></path><defs><marker id="arrowhead99" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1px; stroke-dasharray: 1px, 0px;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-init-cléK1" class="edgeLabel L-LS-init' L-LE-cléK1"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-cléK1-cléK2" class="edgeLabel L-LS-cléK1' L-LE-cléK2"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-cléK2-.." class="edgeLabel L-LS-cléK2' L-LE-.."></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-D" class="edgeLabel L-LS-B' L-LE-D"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-D-..." class="edgeLabel L-LS-D' L-LE-..."></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-E" class="edgeLabel L-LS-B' L-LE-E"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-E-...." class="edgeLabel L-LS-E' L-LE-...."></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-F" class="edgeLabel L-LS-C' L-LE-F"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-F-....." class="edgeLabel L-LS-F' L-LE-....."></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-G" class="edgeLabel L-LS-C' L-LE-G"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-G-......" class="edgeLabel L-LS-G' L-LE-......"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" style="opacity: 1;" id="flowchart-init-292" transform="translate(37.48332977294922,31.35832977294922)"><rect rx="0" ry="0" x="-22.116668701171875" y="-23.35832977294922" width="44.23333740234375" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-12.116668701171875,-13.358329772949219)"><foreignObject width="24.23333740234375" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">init</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-cléK1-293" transform="translate(37.48332977294922,128.07498931884766)"><rect rx="0" ry="0" x="-29.48332977294922" y="-23.35832977294922" width="58.96665954589844" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-19.48332977294922,-13.358329772949219)"><foreignObject width="38.96665954589844" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">cléK1</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-cléK2-294" transform="translate(37.48332977294922,224.7916488647461)"><rect rx="0" ry="0" x="-29.48332977294922" y="-23.35832977294922" width="58.96665954589844" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-19.48332977294922,-13.358329772949219)"><foreignObject width="38.96665954589844" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">cléK2</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-..-295" transform="translate(37.48332977294922,321.50830841064453)"><rect rx="0" ry="0" x="-15.883331298828125" y="-23.35832977294922" width="31.76666259765625" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.883331298828125,-13.358329772949219)"><foreignObject width="11.76666259765625" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">..</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-A-296" transform="translate(317.9916687011719,31.35832977294922)"><rect rx="0" ry="0" x="-18.150001525878906" y="-23.35832977294922" width="36.30000305175781" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-8.150001525878906,-13.358329772949219)"><foreignObject width="16.300003051757812" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-297" transform="translate(187.17082977294922,128.07498931884766)"><rect rx="0" ry="0" x="-18.150001525878906" y="-23.35832977294922" width="36.30000305175781" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-8.150001525878906,-13.358329772949219)"><foreignObject width="16.300003051757812" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-299" transform="translate(431.0041732788086,128.07498931884766)"><rect rx="0" ry="0" x="-35.958335876464844" y="-23.35832977294922" width="71.91667175292969" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-25.958335876464844,-13.358329772949219)"><foreignObject width="51.91667175292969" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1 ^ K1</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-D-301" transform="translate(135.11666107177734,224.7916488647461)"><rect rx="0" ry="0" x="-18.150001525878906" y="-23.35832977294922" width="36.30000305175781" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-8.150001525878906,-13.358329772949219)"><foreignObject width="16.300003051757812" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-...-302" transform="translate(135.11666107177734,321.50830841064453)"><rect rx="0" ry="0" x="-18.824996948242188" y="-23.35832977294922" width="37.649993896484375" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-8.824996948242188,-13.358329772949219)"><foreignObject width="17.649993896484375" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">...</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-304" transform="translate(239.2249984741211,224.7916488647461)"><rect rx="0" ry="0" x="-35.958335876464844" y="-23.35832977294922" width="71.91667175292969" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-25.958335876464844,-13.358329772949219)"><foreignObject width="51.91667175292969" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1 ^ K2</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-....-305" transform="translate(239.2249984741211,321.50830841064453)"><rect rx="0" ry="0" x="-21.76667022705078" y="-23.35832977294922" width="43.53334045410156" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-11.766670227050781,-13.358329772949219)"><foreignObject width="23.533340454101562" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">....</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-F-307" transform="translate(361.1416702270508,224.7916488647461)"><rect rx="0" ry="0" x="-35.958335876464844" y="-23.35832977294922" width="71.91667175292969" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-25.958335876464844,-13.358329772949219)"><foreignObject width="51.91667175292969" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1 ^ K1</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-.....-308" transform="translate(361.1416702270508,321.50830841064453)"><rect rx="0" ry="0" x="-24.708335876464844" y="-23.35832977294922" width="49.41667175292969" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-14.708335876464844,-13.358329772949219)"><foreignObject width="29.416671752929688" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">.....</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-G-310" transform="translate(500.8666763305664,224.7916488647461)"><rect rx="0" ry="0" x="-53.76667022705078" y="-23.35832977294922" width="107.53334045410156" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-43.76667022705078,-13.358329772949219)"><foreignObject width="87.53334045410156" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">c1 ^ K1 ^ K2</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-......-311" transform="translate(500.8666763305664,321.50830841064453)"><rect rx="0" ry="0" x="-27.650001525878906" y="-23.35832977294922" width="55.30000305175781" height="46.71665954589844" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-17.650001525878906,-13.358329772949219)"><foreignObject width="35.30000305175781" height="26.716659545898438"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">......</div></foreignObject></g></g></g></g></g></g></svg></pre>
<blockquote>
<p>le symbole ^ équivault à ⊕ (xor)</p>
</blockquote>
<p>à l’étape une je mets la valeur du ciphertext (celui présent dans output) converti en bytes (il le faut pour la fonction XOR) dans le tableau, et à chaque nouvelle clé dans le liste des clés en clair, je xor chaque valeur du tableau et l’ajoute au tableau si sa valeur n’est pas déjà présente (étant donné que parmi la liste des clés en clair il y a plusieurs fois la même clé, il se peut que cela génère des doublons (spoiler : c’est le cas)). à la fin j’aurais bien mais maximum <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>10</mn></msup></mrow><annotation encoding="application/x-tex">2^{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span></span></span></span></span> valeurs dans le tableau.</p>
<h3 id="récupération-de-la-clé-secrette">Récupération de la clé secrette</h3>
<p>parmi le tableau de ciphertext racine potentiel, seulement <strong>1</strong> est la solution à l’équation : flag ⊕ secretKey. Problème, on ne connait ni le flag, ni la clé secrette. On est BZ. heureusement que dans la description du challenge, on nous indique le flag est de la forme <strong>picoCTF{FLAG}</strong>. Et grâce à cette info, on va retrouver la clé. pour comprendre faisons une petite démonstration :</p>
<blockquote>
<p>flag = p i c o C T F { ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?}<br>
skey = b o n j o u r j e s u i s u n e c l e a u p i f</p>
</blockquote>
<blockquote>
<p>pour le bien de la démonstration la clé est en clair mais supposons qu’elle est inconnue</p>
</blockquote>
<p>que ce passe t’il si on xor ces deux valeurs :</p>
<blockquote>
<p>flag ⊕ skey = <strong>b o n j o u r j</strong> ? ? ? ? ? ? ? ? ? ? ? ?</p>
</blockquote>
<p>on retrouver les premières lettres de la clé. Maintenant place à la pratique !</p>
<h3 id="fonction-decrypt">Fonction decrypt()</h3>
<pre class=" language-py"><code class="prism  language-py"><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>  
  potential_root_ciphertexts <span class="token operator">=</span> get_potential_root_ciphertexts<span class="token punctuation">(</span>value<span class="token punctuation">)</span>  
  <span class="token keyword">for</span> potential_root_ciphertext <span class="token keyword">in</span> potential_root_ciphertexts<span class="token punctuation">:</span>  
	  <span class="token keyword">try</span><span class="token punctuation">:</span>  
		  <span class="token keyword">print</span><span class="token punctuation">(</span>encrypt<span class="token punctuation">(</span>potential_root_ciphertext<span class="token punctuation">,</span>b<span class="token string">'picoCTF{'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token string">"picoCTF{"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
	  <span class="token keyword">except</span><span class="token punctuation">:</span>  
		  <span class="token keyword">pass</span>  
  
 <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>  
	 potential_key <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"As tu une clé ? :"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>  
	 <span class="token keyword">if</span> potential_key <span class="token operator">==</span> b<span class="token string">''</span><span class="token punctuation">:</span> <span class="token keyword">return</span>  
	 <span class="token keyword">for</span> potential_root_ciphertext <span class="token keyword">in</span> potential_root_ciphertexts<span class="token punctuation">:</span>  
		 <span class="token keyword">try</span><span class="token punctuation">:</span>  
			 potential_flag <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>potential_root_ciphertext<span class="token punctuation">,</span> potential_key<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'ascii'</span><span class="token punctuation">)</span>  
			 <span class="token keyword">if</span> <span class="token string">"picoCTF{"</span> <span class="token keyword">in</span> potential_flag<span class="token punctuation">:</span>  
				 <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"find a flag ! :"</span><span class="token punctuation">,</span>potential_flag<span class="token punctuation">)</span>  
		 <span class="token keyword">except</span><span class="token punctuation">:</span>  
			 <span class="token keyword">pass</span>
</code></pre>
<p>le fonction décrypt va xorer chaque ciphertext racine potentiel avec le mot clé <code>picoCTF{</code> et afficher la liste des débuts de clé potentielle. En suite le programme demande à l’utilisateur d’entrer une clé pour déchiffrer le ciphertext racine, l’utilisateur peut faire plusieurs essais si la clé n’est pas triviale.</p>
<h3 id="mise-en-pratique">Mise en pratique</h3>
<pre class=" language-py"><code class="prism  language-py"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> decrypt<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">"57657535570c1e1c612b3468106a18492140662d2f5967442a2960684d28017931617b1f3637"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
decrypting  <span class="token number">57657535570c1e1c612b3468106a18492140662d2f5967442a2960684d28017931617b1f3637</span>
b<span class="token string">"'\x0c\x16Z\x14XXg"</span>
b<span class="token string">'E~s;\x7fx1\x13'</span>
b<span class="token string">'Bzs(q.=\x15'</span>
b<span class="token string">' \x08\x16I\x1a\x0eTa'</span>
b<span class="token string">'Fbrzm7-G'</span>
b<span class="token string">'$\x10\x17\x1b\x06\x17D3'</span>
b<span class="token string">'#\x14\x17\x08\x08AH5'</span>
b<span class="token string">'Africa!A'</span>
b<span class="token string">'N\x7f6;v+7\x0b'</span>
b<span class="token string">',\rSZ\x1d\x0b^\x7f'</span>
b<span class="token string">'+\tSI\x13]Ry'</span>
b<span class="token string">'I{6(x};\r'</span>
b<span class="token string">'/\x11R\x1b\x0fDB+'</span>
b<span class="token string">'Mc7zdd+_'</span>
b<span class="token string">"Jg7ij2'Y"</span>
b<span class="token string">'(\x15R\x08\x01\x12N-'</span>
b<span class="token string">'Ju6?z;*\x1e'</span>
b<span class="token string">'(\x07S^\x11\x1bCj'</span>
b<span class="token string">'/\x03SM\x1fMOl'</span>
b<span class="token string">'Mq6,tm&amp;\x18'</span>
b<span class="token string">'+\x1bR\x1f\x03T_&gt;'</span>
b<span class="token string">'Ii7~ht6J'</span>
b<span class="token string">'Nm7mf":L'</span>
b<span class="token string">',\x1fR\x0c\r\x02S8'</span>
b<span class="token string">'#\x06\x16^\x18HEr'</span>
b<span class="token string">'Ats?sh,\x06'</span>
b<span class="token string">'Fps,}&gt; \x00'</span>
b<span class="token string">'$\x02\x16M\x16\x1eIt'</span>
b<span class="token string">"Bhr~a'0R"</span>
b<span class="token string">' \x1a\x17\x1f\n\x07Y&amp;'</span>
b<span class="token string">"'\x1e\x17\x0c\x04QU "</span>
b<span class="token string">'Elrmoq&lt;T'</span>
As tu une clé ? <span class="token punctuation">:</span>Africa!
find a flag ! <span class="token punctuation">:</span> picoCTF<span class="token punctuation">{</span>w41t_s0_1_d1dnt_1nv3nt_x0r???<span class="token punctuation">}</span>
As tu une clé ? <span class="token punctuation">:</span>
</code></pre>
<hr>
<p>Flag : <code>picoCTF{w41t_s0_1_d1dnt_1nv3nt_x0r???}</code></p>
<p>Auteur : <code>ℜ𝔬𝔪#8216</code></p>

